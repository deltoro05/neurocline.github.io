<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Some Things Are Obvious</title>
    <description>Answers to some of the world&#39;s questions
</description>
    <link>http://neurocline.github.io/</link>
    <atom:link href="http://neurocline.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Fri, 31 Mar 2017 18:11:48 -0700</pubDate>
    <lastBuildDate>Fri, 31 Mar 2017 18:11:48 -0700</lastBuildDate>
    <generator>Jekyll v2.5.3</generator>
    
      <item>
        <title>Writing std::filesystem</title>
        <description>&lt;p&gt;Let’s write our own implementation of std::filesystem. Here’s what we’re going to work from.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/n4618.pdf&quot;&gt;C++17 draft standard&lt;/a&gt; - see 27.10 File systems&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4100.pdf&quot;&gt;File System Technical Specification&lt;/a&gt; - essentially what’s in the standard&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.boost.org/doc/libs/1_42_0/libs/filesystem/doc/index.htm&quot;&gt;Boost Filesystem Library&lt;/a&gt; - the TS came from Boost, after all&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msdn.microsoft.com/en-us/library/hh874694.aspx&quot;&gt;filesystem (Visual Studio 2015)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gcc.gnu.org/onlinedocs/gcc-6.1.0/libstdc++/api/a01832.html&quot;&gt;libcstdc++ Filesystem&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://en.cppreference.com/w/cpp/experimental/fs&quot;&gt;Filesystem library (cppreference.com)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This shipped as &lt;code&gt;std::experimental::filesystem&lt;/code&gt; in Visual Studio 2015 (don’t think VS2017 promoted it to
std::filesystem).&lt;/p&gt;

&lt;p&gt;It shipped as &lt;code&gt;std::experimental::filesystem&lt;/code&gt; in GCC 5.3 in libstdc++.&lt;/p&gt;

&lt;p&gt;While it’s implemented in libc++, also as &lt;code&gt;std::experimental::filesystem&lt;/code&gt;,
it’s not shipping with a Clang version yet (you need to build your own Clang/libc++ to enable it).&lt;/p&gt;

&lt;p&gt;So, let’s just write our own so we can start using it everywhere. Since we’re starting from the fact of
the C++17 standard now including it, we will just create &lt;code&gt;std::filesystem&lt;/code&gt;. This makes our life a little
easier at the moment, since no vendor has yet promoted it out of experimental.&lt;/p&gt;

&lt;h1 id=&quot;ltfilesystemrt&quot;&gt;&amp;lt;filesystem&amp;amp;rt;&lt;/h1&gt;

&lt;p&gt;This is somewhat defined for us in the standard. This goes in the namespace &lt;code&gt;std::filesystem&lt;/code&gt;. We
wrap it like this:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filesystem&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contents&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Note the &lt;code&gt;inline namespace v1&lt;/code&gt;. See &lt;a href=&quot;http://stackoverflow.com/questions/11016220/what-are-inline-namespaces-for&quot;&gt;What are inline namespaces for?&lt;/a&gt; for an explanation about using inline namespaces to help
in API versioning.&lt;/p&gt;

&lt;p&gt;The classes in our namespace:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;filesystem_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;directory_entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;directory_iterator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;recursive_directory_iterator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;file_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;space_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;file_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;perms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;copy_options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;directory_options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trivial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_time_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;There are also a host of non-member functions to implement. We’re going to group these by
functionality, rather than address them all at once.&lt;/p&gt;

&lt;p&gt;Let’s cover trivial stuff first.&lt;/p&gt;

&lt;h1 id=&quot;filetimetype&quot;&gt;file_time_type&lt;/h1&gt;

&lt;p&gt;The standard says that &lt;code&gt;trivial-clock&lt;/code&gt; is an implementation-defined type that satisfies
the C++ concept &lt;code&gt;TrivialClock&lt;/code&gt; (all this means is that this is a clock that would make the
&lt;code&gt;chrono&lt;/code&gt; library happy) and is sufficient to represent the resolution and range of the file time
values offered by the filesystem. What the fuck, standard committee! Right off the bat,
we have something that could differ between filesystems and thus we can’t really pass these
values between file systems.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://en.cppreference.com/w/cpp/concept/TrivialClock&quot;&gt;http://en.cppreference.com/w/cpp/concept/TrivialClock&lt;/a&gt;
for something readable about &lt;code&gt;TrivialClock&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We could take the easy route. Since all the &lt;code&gt;chrono&lt;/code&gt; clocks meet the &lt;code&gt;TrivialClock&lt;/code&gt; requirements,
we could just do this:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_time_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chrono&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_clock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Let’s call that the v0 implementation.&lt;/p&gt;

&lt;p&gt;We’re going to put a line in the sand. Our clock is 64-bit nanoseconds with a zero at 2000/01/01 00:00:00 UTC.
This has the happy property that it’s a superset of Windows &lt;code&gt;FILETIME&lt;/code&gt; and most Linux and Unix filesystems
that I’ve ever heard of, a superset that is losslessly convertible.&lt;/p&gt;

&lt;h1 id=&quot;filetype&quot;&gt;file_type&lt;/h1&gt;

&lt;p&gt;This one is easy, it’s a mandated enum class. The values aren’t mandated, but we’ll put the exceptional
case as -1 and then just number others starting with 0.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;file_type&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;not_found&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;none&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;regular&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;symlink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fifo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;unknown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Note that we end our last enum item with a comma; this is a new best practice in my opinion, because
it means that adding new items can’t go awry or cause extra lines to be edited.&lt;/p&gt;

&lt;h1 id=&quot;copyoptions&quot;&gt;copy_options&lt;/h1&gt;

&lt;p&gt;This one is also easy, another mandated enum class without mandated values. This is a bitmask enum, which
means values will be combined together into a single field. So we just start
with zero and roll up by powers of 2 to create distinct bitmaps.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;copy_options&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;none&lt;/span&gt;                    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// options for existing target files (pick at most one)
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;skip_existing&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b000000001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 0x001,
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;overwrite_existing&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b000000010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 0x002,
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;update_existing&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b000000100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;// 0x004,
&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// options for sub-directories
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;recursive&lt;/span&gt;               &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b000001000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 0x008,
&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// options for symbolic links (pick at most one)
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;copy_symlinks&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b000010000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 0x010,
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;skip_symlinks&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b000100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 0x020,
&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// options for choosing the form of copying (pick at most one)
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;directories_only&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b001000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 0x040,
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;create_symlinks&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b010000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 0x080,
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;create_hardlinks&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// 0x100,
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;perms&quot;&gt;perms&lt;/h1&gt;

&lt;p&gt;This one is also easy, another mandated enum class but with mandated values.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;perms&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;none&lt;/span&gt;                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;// There are no permissions set for the file
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;owner_read&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IRUSR: Read permission, owner
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;owner_write&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IWUSR: Write permission, owner
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;owner_exec&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IXUSR: Execute/search permission, owner
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;owner_all&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IRWXU: read+write+execute, by owner
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;group_read&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0040&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IRGRP: Read permission, group
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;group_write&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0020&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IWGRP: Write permission, group
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;group_exec&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IXGRP: Execute/search permission, group
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;group_all&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0070&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IRWXG: read+write+execute, by group
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;others_read&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0004&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IROTH: Read permission, others
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;others_write&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0002&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IWOTH: Write permission, others
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;others_exec&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IXOTH: Execute/search permission, others
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;others_all&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0007&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// S_IRWXO: read+write+execute, by others
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;all&lt;/span&gt;                 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0777&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// owner_all+group_all+others_all
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;set_uid&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;04000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// S_ISUID: Set-user-ID on execution
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;set_gid&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;02000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// S_ISGID: Set-group-ID on execution
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;sticky_bit&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;01000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// S_ISVTX: Operating system dependent
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;07777&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// all + set_uid + set_gid + sticky_bit
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;unknown&lt;/span&gt;             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xFFFF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// The permissions are not known, such as when a file_status object is created without specifying the permissions
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;add_perms&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// permissions() shall bitwise-or the perm argument&#39;s permissions bits to the file&#39;s current permissions bits
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;remove_perms&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// permissions() shall bitwise-and the complement of perm argument&#39;s permissions bits to the file&#39;s current permission bits
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;symlink_nofollow&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x40000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// permissions() shall change the permissions of symbolic links.
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;directoryoptions&quot;&gt;directory_options&lt;/h1&gt;

&lt;p&gt;This one is also easy, another mandated enum class without mandated values. This is a bitmask enum, which
means values will be combined together into a single field. So we just start
with zero and roll up by powers of 2 to create distinct bitmaps.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;directory_options&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;none&lt;/span&gt;                        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// (Default) Skip directory symlinks, permission denied is an error
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;follow_directory_symlink&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Follow rather than skip directory symlinks
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;skip_permission_denied&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Skip directories that would otherwise result in permission denied
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;spaceinfo&quot;&gt;space_info&lt;/h1&gt;

&lt;p&gt;This is defined in the standard, so hurray, but then the commentary about the &lt;code&gt;space()&lt;/code&gt; function itself
has a bunch of as-if POSIX, instead of just stating the obvious.&lt;/p&gt;

&lt;p&gt;Specifically, &lt;code&gt;capacity&lt;/code&gt; is the total size of the filesystem in bytes; &lt;code&gt;free&lt;/code&gt; is the size of the
unallocated part of the filesystem in bytes; and &lt;code&gt;available&lt;/code&gt; is the number of bytes available to
a non-super user. As such, &lt;code&gt;available&lt;/code&gt; can be less than &lt;code&gt;free&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c--&quot; data-lang=&quot;c++&quot;&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;space_info&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;uintmax_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;capacity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;uintmax_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;uintmax_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</description>
        <pubDate>Fri, 31 Mar 2017 13:30:00 -0700</pubDate>
        <link>http://neurocline.github.io/dev/2017/03/31/writing-std-filesystem.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/03/31/writing-std-filesystem.html</guid>
        
        <category>c++</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Recent links</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://re2c.org/&quot;&gt;re2c&lt;/a&gt;. “re2c is a lexer generator for C/C++”. See &lt;a href=&quot;https://github.com/skvadrik/re2c&quot;&gt;skvadrik/re2c&lt;/a&gt; on Github. This might be fast enough that I would use it instead of writing a hand-written scanner.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jgm/cmark&quot;&gt;cmark&lt;/a&gt;. “CommonMark parsing and rendering library and program in C”. Also see Github’s fork at &lt;a href=&quot;https://github.com/github/cmark&quot;&gt;github/cmark&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://commonmark.org/&quot;&gt;CommonMark&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.github.com/gfm/&quot;&gt;GitHub Flavored Markdown Spec&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jhallen/joes-sandbox/tree/master/editor-perf&quot;&gt;Text Editor Performance Comparison&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://distill.pub/2017/research-debt/&quot;&gt;Research Debt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://bcachefs.org/&quot;&gt;bcachefs&lt;/a&gt;. “The COW filesystem for Linux that won’t eat your data”&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.topbots.com/4-different-approaches-natural-language-processing-understanding&quot;&gt;4 APPROACHES TO NATURAL LANGUAGE PROCESSING &amp;amp; UNDERSTANDING&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 22 Mar 2017 15:00:00 -0700</pubDate>
        <link>http://neurocline.github.io/dev/2017/03/22/recent-links.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/03/22/recent-links.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Recent links</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://courses.csail.mit.edu/6.042/spring17/mcs.pdf&quot;&gt;Mathematics for Computer Science&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://portworx.com/lcfs-speed-up-docker-commit/&quot;&gt;How LCFS speeds up $ docker build by making $ docker commit into a constant time operation&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://blogs.msdn.microsoft.com/dotnet/2017/03/07/announcing-net-core-tools-1-0/&quot;&gt;Announcing .NET Core Tools 1.0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://chrismm.com/blog/writing-good-code-reduce-the-cognitive-load/?2&quot;&gt;Writing good code: how to reduce the cognitive load of your code&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://arxiv.org/pdf/1703.01619.pdf&quot;&gt;Neural Machine Translation and Sequence-to-sequence Models: A Tutorial&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://packagecloud.io&quot;&gt;packagecloud&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wikileaks.org/ciav7p1/&quot;&gt;Vault 7: CIA Hacking Tools Revealed&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/donnemartin/system-design-primer&quot;&gt;donnemartin/system-design-primer&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://arxiv.org/abs/1702.04242v1&quot;&gt;Bizur: A Key-value Consensus Algorithm for Scalable File-systems&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gitly.io/&quot;&gt;gitly&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://spin.atomicobject.com/2017/03/07/attitudes-maintainable-code/&quot;&gt;Three Attitudes that Lead to Maintainable Code&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 08 Mar 2017 17:30:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/03/08/recent-links.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/03/08/recent-links.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Recent links</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://selfie.cs.uni-salzburg.at/&quot;&gt;selfie&lt;/a&gt;. A compiler and VM in 7000 lines of C&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jvns.ca/blog/2013/12/30/questions-im-asking-in-interviews/&quot;&gt;Questions I’m asking in interviews&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://kukuruku.co/post/the-collapse-of-the-unix-philosophy/&quot;&gt;The Collapse of the UNIX Philosophy&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://leverlanguage.com/&quot;&gt;Lever&lt;/a&gt;. New Python-like language with deep GUI/OpenGL integration.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mlg.eng.cam.ac.uk/yarin/blog_2248.html&quot;&gt;Uncertainty in Deep Learning&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://lists.gnu.org/archive/html/groff/2014-02/msg00104.html&quot;&gt;info is dead&lt;/a&gt;. What if info died and no one noticed. This is from 2014.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://undeadly.org/cgi?action=article&amp;amp;sid=20170304230520&quot;&gt;mandoc to markdown converter&lt;/a&gt;. Along with a lot of strong opinion.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://0pointer.net/blog/revisiting-how-we-put-together-linux-systems.html&quot;&gt;Revisiting How We Put Together Linux Systems&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://research.swtch.com/version-sat&quot;&gt;Version SAT&lt;/a&gt;. “Dependency hell is NP-complete. But maybe we can climb out.” Also see &lt;a href=&quot;https://thefeedbackloop.xyz/thoughts-on-dependency-hell-is-np-complete/&quot;&gt;Thoughts on “Dependency hell is NP-complete”&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://slides.com/yehudakatz/deck-4#/&quot;&gt;Zen and the Art of Package Management&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://yarnpkg.com/en/&quot;&gt;Yarn package manager&lt;/a&gt;. Pretty sure it’s just for Javascript. The docs are too cute and don’t seem to get to the point.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.raywenderlich.com/148832/introduction-swift-package-manager&quot;&gt;An Introduction to the Swift Package Manager&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apple/swift-package-manager/blob/master/Documentation/PackageManagerCommunityProposal.md&quot;&gt;Swift Package Manager Community Proposal&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://yurichev.com/blog/minesweeper/&quot;&gt;Cracking Minesweeper with Z3 SMT solver&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 05 Mar 2017 10:00:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/03/05/recent-links.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/03/05/recent-links.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Local package managers</title>
        <description>&lt;p&gt;Recently I read this presentation:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://slides.com/yehudakatz/deck-4#/&quot;&gt;Zen and the Art of Package Management&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I like the terminology of global package manager versus local package manager, so I think
I’ll switch to that instead of “programming language package manager” (too unwieldy).&lt;/p&gt;

&lt;p&gt;Specifically, we want more local package managers and fewer (no) global package managers.
Some existing package managers claimed to be local package managers:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://bundler.io/&quot;&gt;Bundler&lt;/a&gt; - for Ruby&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/&quot;&gt;npm&lt;/a&gt; - for Javascript/Node.js&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://crates.io/&quot;&gt;Cargo&lt;/a&gt; - for Rust&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://yarnpkg.com/en/&quot;&gt;Yarn&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://getcomposer.org/&quot;&gt;Composer&lt;/a&gt; - for PHP&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://pub.dartlang.org/&quot;&gt;Pub&lt;/a&gt; - for Dart&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cocoapods.org/&quot;&gt;Cocoapods&lt;/a&gt; - for Cocoa (Objective-C and Swift)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://swift.org/package-manager/&quot;&gt;Swift Package Manager&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Note, first off, that “local” can go along with “unwieldy” - cocoapods is getting quite
unwieldly, so is npm.&lt;/p&gt;

&lt;p&gt;I also like the clear-call out that containers are solving a problem that shouldn’t
exist - global dependencies. The fewer global dependencies, the fewer container strategies
you need on the development side.&lt;/p&gt;
</description>
        <pubDate>Sun, 05 Mar 2017 03:00:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/03/05/local-package-managers.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/03/05/local-package-managers.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Source Control data models</title>
        <description>&lt;p&gt;I’m going to discuss the designs of the currently popular source control
systems; this is especially important if you want to convert repos from
one system to another. This is notes for both a book on Source Control and
for notes on converting projects from one source control system to another.&lt;/p&gt;

&lt;p&gt;If you want to quibble about the term, see the end of the text.&lt;/p&gt;

&lt;p&gt;There are several distinct systems of design when it comes to making a source
control system, having to do with how you address lines of development. There’s also
how you represent changes explicitly or not; some systems were based on patches as
an implementation detail that couldn’t be changed, some expose patches as a
first-class citizen visible to the user, and some treat patches as an optional
optimization step.&lt;/p&gt;

&lt;p&gt;There are a number of old systems that I used but have forgotten how they worked,
or never knew. They were proprietary, so little was said about their design. In
particular, early systems like PVCS (Polytron Version Control System) and MPW
Projector/SourceServer were used before CVS and SourceSafe existed or were
popular.&lt;/p&gt;

&lt;h2 id=&quot;per-file-revision&quot;&gt;Per-file revision&lt;/h2&gt;

&lt;p&gt;SCCS and its descendants store revisions of individual files; each revision of a
specific file has a version number unrelated to the version numbers in another file.&lt;/p&gt;

&lt;p&gt;As well as per-revision numbers that are assigned automatically, you can assign
a symbolic name to a revision. If you assign the same name to a revision in each file,
you can then refer to that as a tag (a fixed point in revision space) or a branch
(a sliding point). CVS introduced the idea of reserved symbolic names: HEAD refers
to the most recent revision of each file, and BASE the most recent revision you
have fetched locally.&lt;/p&gt;

&lt;p&gt;These treat the trunk separately from branches - the trunk is the initial line of
development, numbered 1.1, 1.2 etc, and then branches start a new numbering scheme
at the point of branching. Thus, by looking at numbering, you can determine the
branching hierarchy. This of course assumes a very centralized system; there is
one source of truth.&lt;/p&gt;

&lt;p&gt;Because tag and branch names share the same namespace and are stored per-file, they
pretty much need to be unique across the entire set of files.&lt;/p&gt;

&lt;p&gt;Because of the consequences of the per-file versioning, removing files is tricky,
and adding files interferes with old history. If you remove a file, its history is
gone. For this reason, CVS introduced an Attic folder on the server, where old files
are moved into. However, of course, if you add a file, remove it, then add it again,
then remove it again, you have a collision.&lt;/p&gt;

&lt;p&gt;All use deltas to store multiple revisions; SCCS and direct descendants like TeamWare
or BitKeeper use interleaved deltas, RCS uses backward-deltas (main line) and forward-deltas
(branches). History has shown that the RCS approach is actually very sub-optimal, but
SCCS isn’t much better. However, deltas are not key to the data model itself, and
are merely to reduce storage size.&lt;/p&gt;

&lt;p&gt;There is locking, but this doesn’t affect the data model, just the usage model.
It’s possible to have or not have locking in any source control system.&lt;/p&gt;

&lt;p&gt;The last thing specific to this kind of system is that they all allow arbitrary
precision when checking out revisions of files. You could have a single file
checked out on a different branch, or directories, or any arbitrary combination
you desire. This is not possible in some other systems (nor is it a good idea,
really).&lt;/p&gt;

&lt;p&gt;The source control systems of this era have keyword expansion, which I hope is
dying out. They also poorly handle binary files, having been made for small text
files.&lt;/p&gt;

&lt;h2 id=&quot;the-set-of-all-revisions-as-a-filesystem&quot;&gt;The set of all revisions as a filesystem.&lt;/h2&gt;

&lt;p&gt;Subversion and Perforce follow a different model. There is a single logical
filesystem that you can address as subsets either for fetching/committing
or for branching. By convention, Subversion uses &lt;code&gt;trunk&lt;/code&gt; as the name for a
mainline, &lt;code&gt;branches&lt;/code&gt; as the root for your individual branches, and &lt;code&gt;tags&lt;/code&gt;
as the root for all your tags, but you can have many projects in a single
Subversion repo, each with their own &lt;code&gt;trunk&lt;/code&gt;, &lt;code&gt;branches&lt;/code&gt; and &lt;code&gt;tags&lt;/code&gt; directories.&lt;/p&gt;

&lt;p&gt;In Subversion, this is implemented as a two-dimensional filesystem where one
axis is the revision number and the other is the pathname, with copy-on-write
to keep storage down to reasonable amounts, and use of diffs per-file to 
control revision storage, much like SCCS and RCS used deltas. However, Subversion
hides the actual storage behind a server, so it can change the implementation
over time as required.&lt;/p&gt;

&lt;p&gt;In Perforce, instead of indexing by revision number, you index by changeset. But
in practice, this is the same thing under a different name, although inside the
implementation it’s possible that changeset is a more rigorous construct, like
Darcs and its “theory of patches”.&lt;/p&gt;

&lt;p&gt;This conceptual model is simple, but has flaws. There is only tagging by convention;
nothing stops you from adding a commit to a “tag”. In that case, strictly speaking,
it’s now a branch, but it remains in the path you gave it, say
&lt;code&gt;/tags/blizzcon-1-build&lt;/code&gt;. Even worse, it’s quite easy by accident to commit
to multiple branches at the same time (and some people see this as a desirable
feature, in multi-project repositories). E.g. you can create a single branch
for multiple projects at the same time.&lt;/p&gt;

&lt;p&gt;Subversion uses a skip-delta scheme that tries to walk a fine line between
CVS (reverse and forward deltas) and SCCS (interleaved deltas).&lt;/p&gt;

&lt;p&gt;Perforce stores tags as metadata, not as entries in the filesystem. It added
streams at some point, which is a more rigorously defined branching model
(changes flow to the mainline, each stream has a parent stream)&lt;/p&gt;

&lt;p&gt;Presumably, Subversion copied Perforce, since Perforce started in 1995 and the
Subversion project didn’t start until 2000.&lt;/p&gt;

&lt;h2 id=&quot;snapshot-dag&quot;&gt;Snapshot DAG&lt;/h2&gt;

&lt;p&gt;In some source control systems, notably Git but also Monotone (its inspiration),
Mercurial and others, the model is actually a set of
snapshots of trees, connected together in a DAG (directed acyclic graph).
A branch is just a copy of a tree, and trees can be merged
together as well; in fact, in Git, it is just as practical to merge together
10 branches as 2 - once the merge is done, further operations on the history
don’t care how many parents a merge has.&lt;/p&gt;

&lt;p&gt;In Git, every other artifact turns into an implementation detail, because the
tree and the following and encoding of trees is the primitive. As such, Git
repositories tend towards single-project use, since it’s easy to branch the
entire repository and harder to branch a part of it. It’s not impossible,
and over time Git has added the ability to do things with subtrees, such as
moving them up or down in the tree without losing the ability to merge, but
its origin is in whole-tree operations.&lt;/p&gt;

&lt;p&gt;Git has shown that many of what were thought to be ideal primitives are in fact
a bad idea. Deltas aren’t a first-class citizen, they should be employed
strictly as a time/space tradeoff. Even renames are inferred in Git, there is
no mechanism to track changes to specific files. What has worked well is that
many operations can be done directly on the DAG, without needing to look at
individual files.&lt;/p&gt;

&lt;p&gt;What you lose is the more free-form ability given by “set of individual files”
or “arbitrary tree”. This means that, even more than between SCCS and Subversion,
going between Subversion and Git means that extra data needs to be kept out of
band (or encoded in band) in order to save all the structure. It’s not hard to
do a one-way transfer, but there are operations in Git that cannot be represented
directly in Subversion (n-way merges) and there are operations in Subversion that
cannot be represented directly in Git (mixed-revision checkouts, single-file
or subtree branches, and especially committing to multiple branches at the same
time). And perhaps the craziest thing in Subversion that is just flat-out illegal
in a DAG is that you can “branch” a subtree back to the root. This is an impossible
cycle in a DAG-based system but a legal (if bizzare) and non-breaking operation
in Subversion.&lt;/p&gt;

&lt;p&gt;Monotone and Mercurial used a manifest as opposed to a tree of directory nodes.
In Monotone, the manifest is a changeset, whereas in Mercurial there are both
manifests and changesets. Monotone attempted a globally unique branch namespace
by proposing that branch names incorporated DNS names and warning when branch
names seemed to not follow this rule. Git avoids this by having branch names
be local per repo, and a user decides how to map branch names in remote repos
to branch names in the local repo.&lt;/p&gt;

&lt;p&gt;TBD: this may not be entirely true for Monotone, Mercurial and others - verify.&lt;/p&gt;

&lt;h2 id=&quot;theory-of-patches&quot;&gt;Theory of patches&lt;/h2&gt;

&lt;p&gt;Some source control systems believe that composing patches is the the single most
important thing, and so are designed around that as the conceptual model. The
most arrogant in this field is Darcs, which at times claims to be the only source
control system based on a strong theoretical backing.&lt;/p&gt;

&lt;h2 id=&quot;history&quot;&gt;History&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;1970 - Clear/Caster&lt;/li&gt;
  &lt;li&gt;1972 - SCCS&lt;/li&gt;
  &lt;li&gt;1980 - DSEE&lt;/li&gt;
  &lt;li&gt;1982 - RCS&lt;/li&gt;
  &lt;li&gt;1985 - PVCS&lt;/li&gt;
  &lt;li&gt;1985 - MPW Projector/SourceServer (eol in 2001)&lt;/li&gt;
  &lt;li&gt;1985 - RCS paper released&lt;/li&gt;
  &lt;li&gt;1986 - CVS as a set of shell scripts&lt;/li&gt;
  &lt;li&gt;1990 - CVS written in C&lt;/li&gt;
  &lt;li&gt;1991 - QVCS (eol in 2010)&lt;/li&gt;
  &lt;li&gt;1991 - Aegis&lt;/li&gt;
  &lt;li&gt;1991 - TeamWare (eol in 2005)&lt;/li&gt;
  &lt;li&gt;1992 - ClearCase (descendent of DSEE)&lt;/li&gt;
  &lt;li&gt;1993 - Vesta&lt;/li&gt;
  &lt;li&gt;1994 - Visual SourceSafe&lt;/li&gt;
  &lt;li&gt;1995 - Perforce&lt;/li&gt;
  &lt;li&gt;1996 - CVS pserver (network access)&lt;/li&gt;
  &lt;li&gt;1998 - CVSNT (fork of CVS for better Windows NT support)&lt;/li&gt;
  &lt;li&gt;1998 - BitKeeper&lt;/li&gt;
  &lt;li&gt;2000 - Subversion development started&lt;/li&gt;
  &lt;li&gt;2001 - Arch/tla (“Tom Lord’s Arch”) (end-of-life in 2009)&lt;/li&gt;
  &lt;li&gt;2002 - AccuRev&lt;/li&gt;
  &lt;li&gt;2003 - ArX (Arch fork)&lt;/li&gt;
  &lt;li&gt;2003 - SVK&lt;/li&gt;
  &lt;li&gt;2004 - Subversion 1.0&lt;/li&gt;
  &lt;li&gt;2004 - ArX 2.0 incompatible with Arch&lt;/li&gt;
  &lt;li&gt;2004 - FastCST (never reached a final state, abandoned)&lt;/li&gt;
  &lt;li&gt;2005 - Team Foundation Server&lt;/li&gt;
  &lt;li&gt;2005 - Baz (Arch fork) came and went in one year&lt;/li&gt;
  &lt;li&gt;2005 - Bazaar development started (dying out in 2016)&lt;/li&gt;
  &lt;li&gt;2005 - Git development started, 1.0 released&lt;/li&gt;
  &lt;li&gt;2006 - Plastic SCM&lt;/li&gt;
  &lt;li&gt;2008 - Subversion 1.5 with decent merge support&lt;/li&gt;
  &lt;li&gt;2013 - Team Foundation Server distributed version&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;features&quot;&gt;Features&lt;/h2&gt;

&lt;p&gt;These are features that are desired by some or all users of source control.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Atomic operations&lt;/li&gt;
  &lt;li&gt;File locking&lt;/li&gt;
  &lt;li&gt;Branching&lt;/li&gt;
  &lt;li&gt;Merging&lt;/li&gt;
  &lt;li&gt;Tags&lt;/li&gt;
  &lt;li&gt;Secure&lt;/li&gt;
  &lt;li&gt;Distributed operation&lt;/li&gt;
  &lt;li&gt;Central/canonical repositories&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;notes-on-source-control-systems&quot;&gt;Notes on source control systems&lt;/h2&gt;

&lt;h3 id=&quot;clearcaster-sdc-cms&quot;&gt;CLEAR/CASTER, SDC, CMS&lt;/h3&gt;

&lt;p&gt;Clear/Caster has a paper for it in 1970 that I haven’t read; I assume as a system it dates back to
just before then. This appears to be unrelated to ClearCase, which was developed by Atria in
1992.&lt;/p&gt;

&lt;p&gt;SDC, CMS.&lt;/p&gt;

&lt;h3 id=&quot;sccs&quot;&gt;SCCS&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;local version control&lt;/li&gt;
  &lt;li&gt;single file history (projects are a fiction)&lt;/li&gt;
  &lt;li&gt;branches, tags&lt;/li&gt;
  &lt;li&gt;interleaved deltas to store multiple revisions&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;SCCS was developed in 1972 by Mark Rochkind, at Bell Labs, and is credited as the first source
control system (so maybe Clear/Caster wasn’t?). It stores version history per file with interleaved
deltas, which means the entire revision file must be read to extract a specific version. In
later versions of SCCS, a recursive mode was added so that an entire tree of SCCS files could
be operated on at once. Interestingly, SCCS wasn’t open-source until 2006.&lt;/p&gt;

&lt;p&gt;I like the phrase I saw in a paper that called SCCS and RCS ‘local version control’: “Local version
control stores the history of the code base on the same disk storage used for the code under
development.”&lt;/p&gt;

&lt;h3 id=&quot;rcs&quot;&gt;RCS&lt;/h3&gt;

&lt;p&gt;Main architecture is pretty much identical to SCCS, with one big difference:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;deltas as the mechanisms of storing multiple revisions&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;RCS is a single-file source control systems, written as a reaction and proposed improvement over
SCCS, with first release in 1982. As in SCCS, each file has individual history, but delta patches
are used to store each version. Each version on the mainline is stored as a reverse delta from the
next most recent version, and branches are stored as forward deltas.&lt;/p&gt;

&lt;p&gt;It’s not strictly true that RCS is a per-file system; if you have a directory named &lt;code&gt;RCS&lt;/code&gt;,
then you could operate on every file inside that RCS directory with a single command. However,
it’s not really practical to use RCS in a multi-directory project.&lt;/p&gt;

&lt;p&gt;The definition of how patches are created and interpreted is baked into the system of each. SCCS/RCS
are only of historical interest, but they had a lot of influence on systems that are alive today.&lt;/p&gt;

&lt;p&gt;Specifically, while SCCS did invent and RCS popularize the base concepts of source control that we
use today, they are a dead-end because of some assumptions that sounded good at the time but turn
out to be wrong - specifically, that deltas are the optimal way to handle changes in a file or set
of files. This received heroic attention over the next 20 years but has been abandoned as not
efficient in both space and access time.&lt;/p&gt;

&lt;p&gt;Also, to be clear, network access wasn’t an issue because there really weren’t networks
at the time; mainframes with terminal access were the rule.&lt;/p&gt;

&lt;p&gt;RCS was closed-source until 1990, when it became open source. This is probably why it supplanted
SCCS and was the base for CVS, and not on its technical merits. This is a lesson for tools
developers - directly make money, or become the standard. In fact, very few closed-source tools
become dominant.&lt;/p&gt;

&lt;h3 id=&quot;cvs&quot;&gt;CVS&lt;/h3&gt;

&lt;p&gt;Main architecture notes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;server-based access&lt;/li&gt;
  &lt;li&gt;whole-project-based (even though back-end storage uses RCS)&lt;/li&gt;
  &lt;li&gt;vendor branches&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;CVS in one respect is a massive hack - it gave the user the ability to work
on sets of files with a single command, but under the hood was just a massive set of RCS revision
files. Thus, the features and design of CVS look remarkably like RCS, except that you can branch
across a set of files in one operation, or check out or commit a set of files, or get history
on a set of files.&lt;/p&gt;

&lt;p&gt;It started out in 1986 as a set of shell scripts running RCS, then by 1990 was reimplemented
in C, and added network access in 1996.&lt;/p&gt;

&lt;p&gt;I don’t want to minimize the addition of a server - this is what made CVS be a credible source
control system and able to be used across a network or even across the Internet. There are
CVS repositories to this day, although no one sane would put a new project in CVS, and if
it were zero effort, people would migrate away from it.&lt;/p&gt;

&lt;p&gt;More importantly, it added a cleaner user abstraction for branches.&lt;/p&gt;

&lt;p&gt;For a brief moment in time (2002-2006), DCVS was an attempt to turn CVS into a distributed
system rather than a centralized system.&lt;/p&gt;

&lt;h3 id=&quot;sourcesafe&quot;&gt;Sourcesafe&lt;/h3&gt;

&lt;p&gt;Imagine a system halfway between RCS and CVS, and you have Sourcesafe. The client handles
checkin of multiple files at the same time, but there is no server. Instead, you put your
database in your file system, whether it’s on your computer or a file server. That decision
led to easy implementation, but you can corrupt the repository quite easily, merely by
having a problem with file system access in the middle of a checkout.&lt;/p&gt;

&lt;p&gt;Only mentioned because it had widespread use, but nothing new over CVS. And yes, VS 2005
added a client/server mode, but SourceSafe had already died its ignominious death by then.&lt;/p&gt;

&lt;h3 id=&quot;clearcase&quot;&gt;ClearCase&lt;/h3&gt;

&lt;p&gt;Main architecture notes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;revisions as a view into the source control system (looking like the raw filesystem)&lt;/li&gt;
  &lt;li&gt;revisions as a set of overlays&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This was developed by Atria in 1992, and is based on an older system from Apollo called
Domain Software Engineering system. It used the clever-in-theory but clumsy-in-practice
metaphor of views into the revision tree - your working folder was a view mapped to the
specific revision of files that you wanted to work on. Persistent sync and performance
issues marred the illusion of seamlessly editing files on your system, however. The
other barrier to widespread use was high cost, not just for the software, but in operating
a ClearCase system; the statement was “one full-time sysop per 40 developers”.&lt;/p&gt;

&lt;h3 id=&quot;teamware&quot;&gt;TeamWare&lt;/h3&gt;

&lt;p&gt;Advanced for its time, but largely only used inside Sun.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;hierarchy of repositories&lt;/li&gt;
  &lt;li&gt;atomic update of multiple files&lt;/li&gt;
  &lt;li&gt;distributed operation (by copying and merging repositories)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is a layer on top of SCCS.&lt;/p&gt;

&lt;h3 id=&quot;bitkeeper&quot;&gt;BitKeeper&lt;/h3&gt;

&lt;p&gt;Interestingly, BitKeeper is a layer on top of SCCS, or on top of a reimplementation of
SCCS. This is because Larry McVoy, the developer, came from working on TeamWare.&lt;/p&gt;

&lt;p&gt;BitKeeper became open-source in 2016 - &lt;a href=&quot;http://www.bitkeeper.org/&quot;&gt;bitkeeper.org&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;source-control-versus-version-control-versus-revision-control&quot;&gt;“Source Control” versus “Version Control” versus “Revision Control”&lt;/h2&gt;

&lt;p&gt;All three of these terms are equivalent:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;source control&lt;/li&gt;
  &lt;li&gt;version control&lt;/li&gt;
  &lt;li&gt;revision control&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Source control as a phrase is geting more popular, and has now edged out
version control - revision control is a distant third as a phrase. See the
Google Ngram viewer:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://books.google.com/ngrams/graph?content=revision+control%2Cversion+control%2C+source+control&amp;amp;year_start=1980&amp;amp;year_end=2010&amp;amp;corpus=15&amp;amp;smoothing=3&amp;amp;share=&amp;amp;direct_url=t1%3B%2Crevision%20control%3B%2Cc0%3B.t1%3B%2Cversion%20control%3B%2Cc0%3B.t1%3B%2Csource%20control%3B%2Cc0&quot;&gt;phrase: source control, version control, revision control&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So, if you like version control better as a phrase, use it or lose it. If you like
revision control as a phrase, that battle was lost from the start - give up and
pick one of the others.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://sccs.sourceforge.net/&quot;&gt;SCCS: The POSIX standard Source Code Control System&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.basepath.com/aup/talks/SCCS-Slideshow.pdf&quot;&gt;The Source Code Control System&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.gnu.org/software/rcs/tichy-paper.pdf&quot;&gt;RCS—A System for Version Control&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://people.ds.cam.ac.uk/fanf2/hermes/doc/talks/2012-04-staffsem/notes.pdf&quot;&gt;Version Control Systems&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.nongnu.org/arx/codecon/img0.html&quot;&gt;ArX Distributed Version Control&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.dwheeler.com/essays/scm.html&quot;&gt;Comments on Open Source Software / Free Software (OSS/FS) Software Configuration Management (SCM) / Revision-Control Systems&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.mercurial-scm.org/wiki/Presentations?action=AttachFile&amp;amp;do=get&amp;amp;target=ols-mercurial-paper.pdf&quot;&gt;Towards a Better SCM: Revlog and Mercurial&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://graydon.livejournal.com/186550.html&quot;&gt;“not rocket science” (the story of monotone and bors)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.monotone.ca/monotone.pdf&quot;&gt;Monotone: A distributed version control system&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://ericsink.com/vcbe/&quot;&gt;Version Control by Example&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://lwn.net/Articles/246381/&quot;&gt;Re: clarification on git, central repositories and commit access lists&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.slideshare.net/JamesCMcPherson/the-great-migration-from-teamware-to-mercurial-presentation&quot;&gt;The Great Migration: from TeamWare to Mercurial&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.perforce.com/sites/default/files/pdf/perforce-for-subversion-users-guide.pdf&quot;&gt;Perforce for Subversion Users&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.perforce.com/sites/default/files/perforce_subversion.pdf&quot;&gt;Comparison: Perforce and Subversion&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/17267218/perforce-for-git-users&quot;&gt;Perforce for Git users&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Wikipedia (note to self: fix all the source control pages)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Revision_Control_System&quot;&gt;RCS&lt;/a&gt;. 1982-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/PVCS&quot;&gt;PVCS&lt;/a&gt;. 1985-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Macintosh_Programmer&#39;s_Workshop&quot;&gt;MPW Projector&lt;/a&gt;. 1985-2001&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/QVCS&quot;&gt;QVCS&lt;/a&gt;. 1991-2013&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Vesta_(Software_configuration_management)&quot;&gt;Vesta&lt;/a&gt;. 1993-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Microsoft_Visual_SourceSafe&quot;&gt;Visual SourceSafe&lt;/a&gt;. 1994-2005&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Perforce_Helix&quot;&gt;Perforce&lt;/a&gt;. 1995-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/CVSNT&quot;&gt;CVSNT&lt;/a&gt;. 1998-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/BitKeeper&quot;&gt;BitKeeper&lt;/a&gt;. 1998-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Apache_Subversion&quot;&gt;Subversion&lt;/a&gt;. 2000-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/GNU_arch&quot;&gt;Arch&lt;/a&gt;. 2001-2009&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Darcs&quot;&gt;DCVS&lt;/a&gt;. 2002-2006&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Surround_SCM&quot;&gt;Surround SCM&lt;/a&gt;. 2002-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Monotone_(software)&quot;&gt;Monotone&lt;/a&gt;. 2003-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/ArX&quot;&gt;Arx&lt;/a&gt;. 2003-2005&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Darcs&quot;&gt;Darcs&lt;/a&gt;. 2003-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Vault_(version_control_system)&quot;&gt;Vault&lt;/a&gt;. 2003-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/SVK&quot;&gt;SVK&lt;/a&gt;. 2003-2010&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Codeville&quot;&gt;Codeville&lt;/a&gt;. 2004-2008&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Git&quot;&gt;Git&lt;/a&gt;. 2005-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Team_Foundation_Server&quot;&gt;Team Foundation&lt;/a&gt;. 2005-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/GNU_Bazaar&quot;&gt;Bazaar&lt;/a&gt;. 2005-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Mercurial&quot;&gt;Mercurial&lt;/a&gt;. 2005-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Fossil_(software)&quot;&gt;Fossil&lt;/a&gt;. 2006-present&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Veracity_(software)&quot;&gt;Veracity&lt;/a&gt;. 2010-present&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Needs a Wikipedia page&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://aegis.sourceforge.net/&quot;&gt;Aegis&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/zedshaw/fcst&quot;&gt;FastCST&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Dead and buried&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;OpenCM: no reference material online any more, and only indirect mentions of it.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;more-notes&quot;&gt;More notes&lt;/h2&gt;

&lt;p&gt;From &lt;a href=&quot;https://lwn.net/Articles/271120/&quot;&gt;Ten-year timeline part 6: almost to the present&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;I didn’t mean to imply that I invented the interesting ideas in monotone. Merely that it, as a
social and researchy development project, both discovered a few fresh ideas and consolidated /
refined many others, and has subsequently been a ripe source of ideas for its successors. I
did some of the work, but also made a ton of mistakes; the key theoretical work we stumbled
through during the course of monotone development was mostly the doing of others. Jerome
Fisher, Nathaniel Smith, Derek Scherger, Bram and Ross Cohen, Timothy Brownawell, Christof
Petig, Richard Levitte, Zack Weinberg, Peter Simons, Daniel Phillips, Emile Snyder, Markus
Schiltknecht, Paul Crowley … and a long list of others who I am probably implicitly
insulting by not mentioning here (sorry, limited comment space).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Names to follow up on when tracking down the origin of both content-addressable and DAG
as pertains to source control.&lt;/p&gt;
</description>
        <pubDate>Fri, 03 Mar 2017 18:00:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/03/03/source-control-architecture.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/03/03/source-control-architecture.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Automatically finding branches in Subversion repos</title>
        <description>&lt;p&gt;Subversion lacks formal mechanism for branches and tags. These are distinct entities
in many other source control systems, but in Subversion these are a combination
of convention and the copy primitive that Subversion has.&lt;/p&gt;

&lt;p&gt;This is awkward for new users of Subversion, who have to learn how to follow the
convention, and even puts a little burden on creators of new repos, who have to
decide what pattern to follow. But it’s an ambiguously flawed feature, because it
does have some benefit - it allowed for mega-repos that contain many independent
projects, each of which could be independently branched, and could even be
cross-branched.&lt;/p&gt;

&lt;p&gt;Of course, all this flexibility comes out as a pain when you want to convert a
Subversion repo to, say, Git. Converting files themselves is trivial; the pain
comes when you want to faithfully represent the old repo’s lines of development.&lt;/p&gt;

&lt;p&gt;There are two typical patterns when using Subversion. The first is to have this
top-level structure for a single-project repository:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/branches
/tags
/trunk
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Your main line of development is in &lt;code&gt;/trunk&lt;/code&gt;, you put branches as directories in
&lt;code&gt;/branches&lt;/code&gt;, and you put tags in &lt;code&gt;/tags&lt;/code&gt;. Oh, right, forgot to mention - Subversion
doesn’t have tagging either. There’s nothing to prevent you from committing to a copy
made in the &lt;code&gt;/tags&lt;/code&gt; hierarchy, thus turning it into a defacto branch, because it’s 
all convention. Hold that thought.&lt;/p&gt;

&lt;p&gt;The other typical pattern is when Subversion is used to host a multi-project
repository. In that case, you might have this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/abdera/
    /branches
    /tags
    /trunk
/accumulo
    /branches
    /tags
    /trunk
...
/httpd
    /branches
    /tags
    /trunk
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you might guess, this is from the Apache Software Foundation repo at
https://svn.apache.org/repos/asf. Except, no, the reality is a lot messier.&lt;/p&gt;

&lt;p&gt;Some projects, like ace or avro, have a handful of files and directories alongside the
&lt;code&gt;trunk&lt;/code&gt; and &lt;code&gt;branches&lt;/code&gt; dirs.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;KEYS
branches/
doap.rdf
releases/
sandbox/
site/
trunk/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;htttp&lt;/code&gt; (Apache) project has a host of nested projects, each of which has its
own &lt;code&gt;branches&lt;/code&gt;, &lt;code&gt;tags&lt;/code&gt; and &lt;code&gt;trunk&lt;/code&gt;. This is a subset, in the interests of space:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;apreq/
docs-build/
flood/
httpd/
    branches/
    tags/
    trunk/
    vendor/
    win32-msi/
mod_fcgid/
mod_ftp/
    branches/
    tags/
    trunk/
mod_mbox/
mod_spdy/
mod_wombat/
sandbox/
site/
test/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And maven - well, maven is its own special child. This is a subset of the top level:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;app-engine/
archetype/
maven-1/
maven-2/
maven-3/
project/
release/
resources/
retired/
scm/
shared/
site/
trunks/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Look, a &lt;code&gt;trunks&lt;/code&gt; directory. Which is - empty? And the &lt;code&gt;maven-1&lt;/code&gt; dir has an empty
&lt;code&gt;trunks&lt;/code&gt;. We finally find source in &lt;code&gt;/maven/maven-2/branches&lt;/code&gt;. And the mainline
of development is really &lt;code&gt;/maven/maven-3/trunk&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;So, while the ASF repo is an example of the multi-project repo approach, it’s
also an example of the heterogeniety of large Subversion repos. The approach up
until now when converting a repo is that you have to describe the structure, which
can be time-consuming, and you can get it wrong. But maybe that’s enough?&lt;/p&gt;

&lt;p&gt;What about the fact that Subversion copy operations can be of any subset and can
do topologically-absurd actions? For example, copying root to a point in the
tree, or copying a point in the tree to a parent of that point?&lt;/p&gt;

&lt;p&gt;By the way, it is possible to compose a Git repo as a Subversion repo, it’s just
bizarre and unwieldly. Take master and all branches, and add them as subtrees
of a new root. This takes up almost no space in the Git repository, just like with
Subversion. The difference is that unless you do selective checkout, you’re going
to have a very large working folder. Selective checkout is the default behavior
in Subversion.&lt;/p&gt;
</description>
        <pubDate>Tue, 28 Feb 2017 13:53:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/02/28/automatically-finding-branches-in-subversion-repos.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/02/28/automatically-finding-branches-in-subversion-repos.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Recent links</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://sacha.me/articles/jekyll-rouge/&quot;&gt;Syntax Highlighting in Jekyll With Rouge&lt;/a&gt;. Switch to GFM.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lowleveldesign/wtrace&quot;&gt;wtrace&lt;/a&gt;. Uses ETW.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@tonywangcn/how-to-build-a-scaleable-crawler-to-crawl-million-pages-with-a-single-machine-in-just-2-hours-ab3e238d1c22#.97tw3lgs6&quot;&gt;How to build a scaleable crawler to crawl million pages with a single machine in just 2 hours&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://probablydance.com/2017/02/26/i-wrote-the-fastest-hashtable/&quot;&gt;I Wrote The Fastest Hashtable&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://idea.popcount.org/2017-02-20-epoll-is-fundamentally-broken-12/&quot;&gt;Epoll is fundamentally broken&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.jotaen.net/e7ywT/deploying-static-website-to-aws/&quot;&gt;Fast, Cheap And Automated: Deploying Static Websites To AWS&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://benchmarksgame.alioth.debian.org/&quot;&gt;The Computer Language Benchmarks Game&lt;/a&gt;. I don’t know how to get to specific ones like &lt;a href=&quot;http://benchmarksgame.alioth.debian.org/u64q/performance.php?test=knucleotide&quot;&gt;k-nucleotide&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://rystsov.info/2017/02/15/simple-consensus.html&quot;&gt;In search of a simple consensus algorithm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/transceptor-technology/pyleri&quot;&gt;pyleri&lt;/a&gt;. Python left-right parser.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://treefrogframework.github.io/cpi/&quot;&gt;cpi: tiny C++ interpreter&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 28 Feb 2017 11:00:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/02/28/recent-links.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/02/28/recent-links.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Clustering</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Cluster_analysis&quot;&gt;Cluster Analysis&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://hdbscan.readthedocs.io/en/latest/comparing_clustering_algorithms.html&quot;&gt;Comparing Python Clustering Algorithms&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.ims.uni-stuttgart.de/institut/mitarbeiter/schulte/theses/phd/algorithm.pdf&quot;&gt;Clustering Algorithms and Evaluations&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 28 Feb 2017 10:00:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/02/28/clustering.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/02/28/clustering.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
      <item>
        <title>Recent links</title>
        <description>&lt;p&gt;It looks like Gnuplot is still in CVS. This is the first live project I’ve come across
that is still in CVS.&lt;/p&gt;

&lt;p&gt;https://sourceforge.net/p/gnuplot/code/?source=navbar&lt;/p&gt;

&lt;p&gt;Some bits about Python object-oriented code, because I’m a beginner.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://rhettinger.wordpress.com/2011/05/26/super-considered-super/&quot;&gt;Python’s super() considered super!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jeffknupp.com/blog/2014/06/18/improve-your-python-python-classes-and-object-oriented-programming/&quot;&gt;Improve Your Python: Python Classes and Object Oriented Programming&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/576169/understanding-python-super-with-init-methods&quot;&gt;Understanding Python super() with &lt;strong&gt;init&lt;/strong&gt;() methods&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://fuhm.net/super-harmful/&quot;&gt;Python’s Super is nifty, but you can’t use it&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://amyboyle.ninja/Python-Inheritance&quot;&gt;Multiple Inheritance Minefield&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Dylan added things to the computing landscape. One of them was the C3 superclass linearization
algorithm, and is also called Method Resolution Order (MRO). Python started using it in 2.3.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/C3_linearization&quot;&gt;C3 linearization&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.python.org/download/releases/2.3/mro/&quot;&gt;The Python 2.3 Method Resolution Order&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://python-history.blogspot.com/2010/06/method-resolution-order.html&quot;&gt;Method Resolution Order&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.19.3910&amp;amp;rep=rep1&amp;amp;type=pdf&quot;&gt;A Monotonic Superclass Linearization for Dylan&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Sun, 19 Feb 2017 19:00:00 -0800</pubDate>
        <link>http://neurocline.github.io/dev/2017/02/19/recent-links.html</link>
        <guid isPermaLink="true">http://neurocline.github.io/dev/2017/02/19/recent-links.html</guid>
        
        <category>text</category>
        
        
        <category>dev</category>
        
      </item>
    
  </channel>
</rss>
